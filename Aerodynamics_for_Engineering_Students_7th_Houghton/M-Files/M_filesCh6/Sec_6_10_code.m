% N is number of panels used to model elliptical surface.
clear;clc
%
% NACA 4-digit airfoil: 4412
%
% clear;clc
c = 1;
Nthe = 201;
the = 0:-2*pi/Nthe:-pi;
x = (1 + cos(the) )/2;
m=4/100; p=4/10; t = 0.12;
yt = 5*t*c .* (.2969*x.^0.5 - .126*x ...
- .3516*x.^2 + .2843*x.^3 - .1015*x.^4); %yt(length(x))=0;
for n=1:length(x)
if x <= p
yc(n) = (m*c/p)*(2*p*x(n)-x(n)^2);
else
yc(n) = (m*c/(1-p)^2)*((1-2*p) + 2*p*x(n) - x(n)^2);
end
end
XPU = x; YPU = yt + yc;
for n = 1:length(x)-1
XPL(n) = x(length(x)-n);
YPL(n) = yc(length(x)-n) - yt(length(x)-n);
end
XP = [XPU(1:end) XPL(1:end-1)];
YP = [YPU(1:end) YPL(1:end-1)];
% Inherent camber angle of attack = atan(0.022)*180/pi = 1.3
alpha = 4.2; alp = pi*alpha/180; N = length(XP);
NT = 1; NTp1 = N;
% for m = 1:N
% YP(m) = YP(m) - sin(alpha*pi/180)*XP(m);
% end
figure(1);plot(XP,YP,'-o')
%
[AN,AT,XC,YC,NHAT,THAT] = InfluSourV(XP,YP,N,NTp1,NT);
% uinfty = 1;
for j=1:N
b(j,1) = cos(alp)*NHAT(j,1) + sin(alp)*NHAT(j,2);
end
b(N+1,1) = - ( THAT(NT,1) + THAT(NT+1,1));
Sources = AN\b;
THAT(N+1,1) = 0; THAT(N+1,2) = 0;
ut = AT*Sources - THAT(:,1);
cp = 1 - ut.^2;
figure(2);
plot(XC,1-cp(1:end-1),'k')
xlabel(' x '),ylabel(' 1-Cp '),axis([0 1 0 3])
title(' NACA 4412 airfoil at C_L \approx 1.09')
%
hold on
A = [1.0000 0.134
0.9792 0.167
0.9486 0.180
0.8990 0.203
0.8491 0.211
0.7492 0.231
0.6494 0.244
0.5448 0.250
0.4998 0.262
0.4490 0.268
0.3998 0.265
0.3490 0.290
0.2996 0.293
0.2490 0.313
0.1998 0.321
0.1494 0.345
0.0996 0.402
0.0738 0.462
0.0494 0.568
0.0292 0.748
0.0166 0.916
0.0092 1.013
0.0036 0.905
0.0000 0.157
0.0000 -1.000
0.0044 -1.740
0.0094 -1.793
0.0170 -1.743
0.0294 -1.647
0.0490 -1.547
0.0750 -1.432
0.0996 -1.391
0.1258 -1.350
0.1492 -1.308
0.1744 -1.272
0.1996 -1.239
0.2244 -1.224
0.2492 -1.163
0.2744 -1.122
0.2988 -1.071
0.3498 -0.982
0.3990 -0.880
0.4480 -0.809
0.4992 -0.690
0.5492 -0.601
0.5994 -0.541
0.6490 -0.456
0.6986 -0.371
0.7490 -0.285
0.7992 -0.199
0.8488 -0.106
0.8988 -0.009
0.9490 0.079
0.9800 0.120 ];
plot(A(:,1),1-A(:,2),'ok')
Drela= [ 1.00000 0.18788
0.99392 0.17318
0.98332 0.14468
0.97097 0.10993
0.95716 0.07020
0.94236 0.02829
0.92695 -0.01410
0.91123 -0.05511
0.89533 -0.09452
0.87933 -0.13197
0.86328 -0.16771
0.84720 -0.20166
0.83108 -0.23430
0.81494 -0.26571
0.79879 -0.29600
0.78261 -0.32532
0.76643 -0.35418
0.75022 -0.38206
0.73401 -0.40973
0.71778 -0.43672
0.70155 -0.46342
0.68530 -0.49006
0.66905 -0.51620
0.65280 -0.54230
0.63654 -0.56849
0.62028 -0.59456
0.60402 -0.62065
0.58776 -0.64680
0.57151 -0.67335
0.55525 -0.69992
0.53901 -0.72692
0.52278 -0.75424
0.50655 -0.78225
0.49035 -0.81066
0.47416 -0.83994
0.45799 -0.87032
0.44186 -0.90204
0.42579 -0.93564
0.40980 -0.97231
0.39397 -1.01717
0.37833 -1.05592
0.36279 -1.08967
0.34732 -1.12116
0.33191 -1.15066
0.31655 -1.17857
0.30126 -1.20503
0.28603 -1.23025
0.27087 -1.25409
0.25578 -1.27652
0.24079 -1.29823
0.22589 -1.31839
0.21110 -1.33793
0.19644 -1.35591
0.18193 -1.37340
0.16758 -1.38971
0.15344 -1.40546
0.13953 -1.42067
0.12593 -1.43555
0.11269 -1.44998
0.09993 -1.46503
0.08776 -1.47915
0.07634 -1.49247
0.06582 -1.50382
0.05633 -1.52458
0.04792 -1.56921
0.04059 -1.58460
0.03426 -1.60531
0.02881 -1.62630
0.02412 -1.64583
0.02008 -1.66365
0.01659 -1.67754
0.01357 -1.68606
0.01094 -1.68724
0.00867 -1.67756
0.00670 -1.65374
0.00501 -1.61075
0.00359 -1.54117
0.00241 -1.43814
0.00147 -1.29278
0.00077 -1.09919
0.00029 -0.85909
0.00004 -0.58168
0.00001 -0.28605
0.00021 0.02077
0.00065 0.32660
0.00138 0.59604
0.00239 0.79958
0.00369 0.92722
0.00528 0.98828
0.00713 0.99891
0.00926 0.97656
0.01168 0.93422
0.01440 0.88214
0.01746 0.82493
0.02091 0.76709
0.02480 0.71033
0.02922 0.65555
0.03427 0.60408
0.04008 0.55536
0.04680 0.50994
0.05460 0.46962
0.06364 0.43483
0.07401 0.40097
0.08570 0.37226
0.09862 0.34895
0.11256 0.33033
0.12730 0.31570
0.14264 0.30445
0.15843 0.29574
0.17455 0.28924
0.19092 0.28450
0.20751 0.28066
0.22425 0.27805
0.24114 0.27594
0.25813 0.27433
0.27519 0.27280
0.29228 0.27161
0.30934 0.27018
0.32635 0.26870
0.34332 0.26659
0.36025 0.26424
0.37715 0.26084
0.39405 0.25549
0.41101 0.24725
0.42803 0.24268
0.44511 0.23917
0.46224 0.23649
0.47939 0.23425
0.49656 0.23235
0.51374 0.23081
0.53090 0.22945
0.54805 0.22806
0.56518 0.22690
0.58229 0.22572
0.59939 0.22469
0.61647 0.22353
0.63354 0.22217
0.65060 0.22122
0.66765 0.21987
0.68469 0.21863
0.70172 0.21718
0.71875 0.21582
0.73577 0.21406
0.75280 0.21246
0.76981 0.21090
0.78683 0.20898
0.80385 0.20727
0.82087 0.20524
0.83789 0.20323
0.85491 0.20137
0.87191 0.19918
0.88889 0.19739
0.90581 0.19580
0.92257 0.19400
0.93901 0.19324
0.95482 0.19284
0.96952 0.19391
0.98258 0.19568
0.99368 0.20266
1.00000 0.18788];
plot(Drela(:,1),1-Drela(:,2),'--k')
